{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="section-content padding-y bg">
  <div class="container">
    <div class="row">

      <aside class="col-lg-8">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Billing Details</h4>
          </div>
          <div class="card-body">
            <form action="{% url 'place_order' %}" method="POST" id="place-order-form">
              {% csrf_token %}
              <div class="form-row">
                <div class="col form-group">
                  <label for="id_first_name">First Name</label>
                  <input type="text" class="form-control" name="first_name" id="id_first_name" 
                         value="{{ request.user.first_name|default_if_none:'' }}" required>
                </div>
                <div class="col form-group">
                  <label for="id_last_name">Last Name</label>
                  <input type="text" class="form-control" name="last_name" id="id_last_name" 
                         value="{{ request.user.last_name|default_if_none:'' }}" required>
                </div>
              </div>
              
              <div class="form-row">
                <div class="col form-group">
                  <label for="id_email">Email</label>
                  <input type="email" class="form-control" name="email" id="id_email" 
                         value="{{ request.user.email|default_if_none:'' }}" required>
                </div>
                <div class="col form-group">
                  <label for="id_phone">Phone</label>
                  <input type="tel" class="form-control" name="phone" id="id_phone" 
                         value="{{ request.user.phone_number|default_if_none:'' }}" required>
                </div>
              </div>
              
              <div class="form-group">
                <label for="id_address_line_1">Address Line 1</label>
                <input type="text" class="form-control" name="address_line_1" id="id_address_line_1" required>
              </div>
              
              <div class="form-group">
                <label for="id_address_line_2">Address Line 2 (Optional)</label>
                <input type="text" class="form-control" name="address_line_2" id="id_address_line_2">
              </div>
              
              <div class="form-row">
                <div class="form-group col-md-4">
                  <label for="id_country">Country</label>
                  <input type="text" class="form-control" name="country" id="id_country" required>
                </div>
                <div class="form-group col-md-4">
                  <label for="id_state">State</label>
                  <input type="text" class="form-control" name="state" id="id_state" required>
                </div>
                <div class="form-group col-md-4">
                  <label for="id_city">City</label>
                  <input type="text" class="form-control" name="city" id="id_city" required>
                </div>
              </div>
              
              <div class="form-group">
                <label for="id_order_note">Order Note (Optional)</label>
                <textarea class="form-control" name="order_note" id="id_order_note" rows="3"></textarea>
              </div>
              
              <!-- Payment Method Selection -->
              <!-- <div class="form-group">
                <label>Payment Method</label>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="payment_method" id="paypal" value="PayPal" checked>
                  <label class="form-check-label" for="paypal">
                    <i class="fab fa-paypal"></i> PayPal
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="payment_method" id="credit_card" value="Credit Card">
                  <label class="form-check-label" for="credit_card">
                    <i class="fab fa-cc-visa"></i> Credit Card
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="payment_method" id="cash" value="Cash">
                  <label class="form-check-label" for="cash">
                    <i class="fas fa-money-bill-wave"></i> Cash on Delivery
                  </label>
                </div>
              </div> -->
              
              <!-- <div class="form-group">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="terms" required>
                  <label class="form-check-label" for="terms">
                    I agree to the <a href="#">Terms and Conditions</a>
                  </label>
                </div>
              </div> -->
              
              <button type="submit" class="btn btn-primary btn-block">Place Order</button>
            </form>
          </div>
        </div>
      </aside>
      
      <aside class="col-lg-4">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Your Order</h4>
          </div>
          <div class="card-body">
            <table class="table table-borderless table-shopping-cart">
              <thead class="text-muted">
                <tr class="small text-uppercase">
                  <th scope="col">Product</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">Price</th>
                </tr>
              </thead>
              <tbody>
                {% for cart_item in cart_items %}
                <tr>
                  <td>
                    <figure class="itemside align-items-center">
                      <div class="aside">
                        <img src="{{ cart_item.product.images.url }}" class="img-sm">
                      </div>
                      <figcaption class="info">
                        <a href="{{ cart_item.product.get_url }}" class="title text-dark">
                          {{ cart_item.product.product_name }}
                        </a>
                      </figcaption>
                    </figure>
                  </td>
                  <td>{{ cart_item.quantity }}</td>
                  <td>
                    <div class="price-wrap">
                      <var class="price">${{ cart_item.sub_total }}</var>
                      <small class="text-muted">${{ cart_item.product.price }} each</small>
                    </div>
                  </td>
                </tr> 
                {% endfor %}
              </tbody>
            </table>
            
            <dl class="dlist-align">
              <dt>Subtotal:</dt>
              <dd class="text-right">${{ total }}</dd>
            </dl>
            <dl class="dlist-align">
              <dt>Tax:</dt>
              <dd class="text-right">${{ tax }}</dd>
            </dl>
            <dl class="dlist-align">
              <dt>Grand Total:</dt>
              <dd class="text-right text-dark"><strong>${{ grand_total }}</strong></dd>
            </dl>
            <hr />
            <p class="text-center mb-3">
              <img
                src="{% static './images/misc/payments.png' %}"
                height="26"
              />
            </p>
            <!-- <a href="{% url 'place_order' %}" class="btn btn-primary btn-block">Place Order</a>
             -->
            <a href="{% url 'store' %}" class="btn btn-light btn-block"
              >Continue Shopping</a>
          </div>
        </div>
        
        <!-- <div class="alert alert-info mt-3">
          <p class="icontext"><i class="icon text-primary fa fa-truck"></i> Free Delivery within 1-2 weeks</p>
        </div> -->
      </aside>


    </div>
  </div>
</section>
{% endblock %}